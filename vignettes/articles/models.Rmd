---
title: "Models in bbsBayes"
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(bbsBayes)
```

There are 9 types of models that can be run with bbsBayes. For a quick overview
you can access the `bbs_models` data frame.

```{r}
bbs_models
```

```{r}
s <- stratify(by = "bbs_cws", sample_data = TRUE)
p <- prepare_data(s)
```





## 1. First Difference Models (`first_diff`)

### Non-hierarchical

### Hierarchical

### Spatial


## 2. General Additive Models (`gam`)

### Hierarchical

### Spatial


## 3. General Additive Models Year Effect(`gamye`)

### Hierarchical

### Spatial


## 4. Slope (`slope`)

### Hierarchical

### Spatial


# Customizing the Model Run

## Customizing initial parameter values

To customize the initial parameter values you can create the model data with
`prepare_model()` and then either edit or overwrite the `init_values` item in
the list.

```{r}
md <- prepare_model(p, model = "first_diff", model_variant = "hier")
```

Make some changes to the `init_values` and pass the `model_data` to
`run_model()`.

```{r}
md[["init"]][["sdnoise"]] <- 0.5

m <- run_model(md, model = "first_diff",
               iter_warmup = 20, iter_sampling = 20, chains = 2)
```

Note that you can supply different init values for each chain. If you supply one
set of init values (which is what `prepare_model()` outputs), `run_model()`, 
will duplicate them for each chain for you. If you supply a list of init values
such that the length is the same as the number of chains, your input will be 
used as is.

## Customize Stan Model File

Copy model file (and modify by hand in text editor)
```{r}
new_model <- copy_model_file("first_diff", "hier", tempdir())
new_model
```

Then give the file path of this new file to `prepare_model()`
```{r}
model_data <- prepare_model(p, model = "first_diff", model_variant = "hier",
                   model_file = new_model)
```

